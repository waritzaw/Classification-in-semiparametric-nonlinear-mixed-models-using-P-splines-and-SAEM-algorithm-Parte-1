resp <- ypred + yspline
return(resp)
}
MSP7 <- MMSP.basis(x, min(x), max(x), ndx = 7, bdeg = bdeg, pord = pord, param = param)
names(MSP7)
X <- MSP7$X
Z <- MSP7$Z
aX <- dim(X)[2]
aZ <- dim(Z)[2]
aD <- dim(dataEA)[2]
RES <- cbind(X,Z)
dataEA7.full <-cbind(dataEA,Z)
colnames(dataEA7.full)[(aD+1):(aD+aZ)] <- paste0("Z",1:ncol(Z))
dataEA7.full.data <- saemixData(name.data = dataEA7.full, header = TRUE,
sep = " ", na = NA,
name.predictors = c("time",paste0("Z",1:aZ)),
name.response = c("y"),
units = list(x = "days", y = "log(beta-HCG)",
covariates = c("-")),
name.X = c("time"))
# Data SPNLME model EA 7 knots
write.csv(dataEA7.full, file = "dataEA-SPNLME7.csv", row.names = FALSE)
plot(dataEA7.full.data, plot.type="data")
SPEA7.saemix <-saemixModel(model=model.7n,
description = "SPNLME Model knots = 7",
psi0 = matrix(c(coef(nlmeEA.fit)$fixed,rep(0,8)), ncol = 3+aZ, byrow = TRUE,
dimnames = list(NULL, c("a","b","c","b1","b2","b3","b4","b5","b6","b7","b8"))),
transform.par = c(rep(0,3),rep(0,aZ)),
fixed.estim=c(rep(1,3+aZ)),
covariance.model = cbind(rbind(diag(11))))
##RUNS
K3 = 500
K4 = 100
c4 = 5
c5 = 5
c6 = 5
iterations = 1:(K3+K4+1)
end = K3+K4
options.sp<-list(seed=139546,map=FALSE,fim=FALSE,ll.is=TRUE,nb.chains = 5,
nbiter.mcmc = c(c4,c5,c6,0), nbiter.saemix = c(K3,K4),nbiter.sa=0.9,
displayProgress=TRUE,save.graphs=FALSE,nbiter.burn =0)
SPEA7.fit <- saemix(SPEA7.saemix, dataEA7.full.data, options.sp)
plot(SPEA7.fit, plot.type="individual.fit")
pdf("SPNLME-EA.7k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA7.fit) ~ time | id, data = dataEA7.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 7k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 7 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
######### Model 4 ###########
model.8n <-function(psi, id, x){
RES <- x
tim<-RES[,1]
a<-psi[id,1]
b<-psi[id,2]
c<-psi[id,3]
ypred<-a/(1+exp(-(tim-b)/c))
return(ypred)
##
b1<- psi[id, 4]
b2<- psi[id, 5]
b3<- psi[id, 6]
b4<- psi[id, 7]
b5<- psi[id, 8]
b6<- psi[id, 9]
b7<- psi[id, 10]
b8<- psi[id, 11]
b9<- psi[id, 12]
yspline <- RES[,2]*b1 + RES[,3]*b2 + RES[,4]*b3 + RES[,5]*b4 +
RES[,6]*b5 + RES[,7]*b6 + RES[,8]*b7 + RES[,9]*b8 +
RES[,10]*b9
resp <- ypred + yspline
return(resp)
}
MSP8 <- MMSP.basis(x, min(x), max(x), ndx = 8, bdeg = bdeg, pord = pord, param = param)
names(MSP8)
X <- MSP8$X
Z <- MSP8$Z
aX <- dim(X)[2]
aZ <- dim(Z)[2]
aD <- dim(dataEA)[2]
RES <- cbind(X,Z)
dataEA8.full <-cbind(dataEA,Z)
colnames(dataEA8.full)[(aD+1):(aD+aZ)] <- paste0("Z",1:ncol(Z))
dataEA8.full.data <- saemixData(name.data = dataEA8.full, header = TRUE,
sep = " ", na = NA,
name.predictors = c("time",paste0("Z",1:aZ)),
name.response = c("y"),
units = list(x = "days", y = "log(beta-HCG)",
covariates = c("-")),
name.X = c("time"))
# Data SPNLME model EN 8 knots
write.csv(dataEA8.full, file = "dataEA-SPNLME8.csv", row.names = FALSE)
plot(dataEA8.full.data, plot.type="data")
SPEA8.saemix <-saemixModel(model=model.8n,
description = "SPNLME model knots = 8",
psi0 = matrix(c(coef(nlmeEA.fit)$fixed,rep(0,9)), ncol = 3+aZ, byrow = TRUE,
dimnames = list(NULL, c("a","b","c","b1","b2","b3","b4","b5","b6","b7","b8","b9"))),
transform.par = c(rep(0,3),rep(0,aZ)),
fixed.estim=c(rep(1,3+aZ)),
covariance.model = cbind(rbind(diag(12))))
##RUNS
K3 = 500
K4 = 100
c4 = 5
c5 = 5
c6 = 5
iterations = 1:(K3+K4+1)
end = K3+K4
options.sp<-list(seed=139546,map=FALSE,fim=FALSE,ll.is=TRUE,nb.chains = 5,
nbiter.mcmc = c(c4,c5,c6,0), nbiter.saemix = c(K3,K4),nbiter.sa=0.9,
displayProgress=TRUE,save.graphs=FALSE,nbiter.burn =0)
SPEA8.fit <- saemix(SPEA8.saemix, dataEA8.full.data, options.sp)
plot(SPEA8.fit, plot.type="individual.fit")
pdf("SPNLME-EA.8k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA8.fit) ~ time | id, data = dataEA8.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 8k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 8 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
model.9n <-function(psi, id, x){
RES <- x
tim<-RES[,1]
a<-psi[id,1]
b<-psi[id,2]
c<-psi[id,3]
ypred<-a/(1+exp(-(tim-b)/c))
return(ypred)
##
b1<- psi[id, 4]
b2<- psi[id, 5]
b3<- psi[id, 6]
b4<- psi[id, 7]
b5<- psi[id, 8]
b6<- psi[id, 9]
b7<- psi[id, 10]
b8<- psi[id, 11]
b9<- psi[id, 12]
b10<-psi[id, 13]
yspline <- RES[,2]*b1 + RES[,3]*b2 + RES[,4]*b3 + RES[,5]*b4 + RES[,6]*b5 +
RES[,7]*b6 + RES[,8]*b7 + RES[,9]*b8 + RES[,10]*b9 + RES[,11]*b10
resp <- ypred + yspline
return(resp)
}
MSP9 <- MMSP.basis(x, min(x), max(x), ndx = 9, bdeg = bdeg, pord = pord, param = param)
names(MSP9)
X <- MSP9$X
Z <- MSP9$Z
aX <- dim(X)[2]
aZ <- dim(Z)[2]
aD <- dim(dataEA)[2]
RES <- cbind(X,Z)
dataEA9.full <-cbind(dataEA,Z)
colnames(dataEA9.full)[(aD+1):(aD+aZ)] <- paste0("Z",1:ncol(Z))
dataEA9.full.data <- saemixData(name.data = dataEA9.full, header = TRUE,
sep = " ", na = NA,
name.predictors = c("time",paste0("Z",1:aZ)),
name.response = c("y"),
units = list(x = "days", y = "log(beta-HCG)",
covariates = c("-")),
name.X = c("time"))
# Data SPNLME model EN 9 knots
write.csv(dataEA9.full, file = "dataEA-SPNLME9.csv", row.names = FALSE)
plot(dataEA9.full.data, plot.type="data")
SPEA9.saemix <-saemixModel(model=model.9n,
description = "SPNLME model knots = 9",
psi0 = matrix(c(coef(nlmeEA.fit)$fixed,rep(0,10)), ncol = 3+aZ, byrow = TRUE,
dimnames = list(NULL, c("a","b","c","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10"))),
transform.par = c(rep(0,3),rep(0,aZ)),
fixed.estim=c(rep(1,3+aZ)),
covariance.model = cbind(rbind(diag(13))))
##RUNS
K3 = 500
K4 = 100
c4 = 5
c5 = 5
c6 = 5
iterations = 1:(K3+K4+1)
end = K3+K4
options.sp<-list(seed=139546,map=FALSE,fim=FALSE,ll.is=TRUE,nb.chains = 5,
nbiter.mcmc = c(c4,c5,c6,0), nbiter.saemix = c(K3,K4),nbiter.sa=0.9,
displayProgress=TRUE,save.graphs=FALSE,nbiter.burn =0)
SPEA9.fit <- saemix(SPEA9.saemix, dataEA9.full.data, options.sp)
plot(SPEA9.fit, plot.type="individual.fit")
library(lattice)
pdf("SPNLME-EA.9k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA9.fit) ~ time | id, data = dataEA9.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 9k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 9 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
######### Model 6 ###########
model.10n <-function(psi, id, x){
RES <- x
tim<-RES[,1]
a<-psi[id,1]
b<-psi[id,2]
c<-psi[id,3]
ypred<-a/(1+exp(-(tim-b)/c))
return(ypred)
##
b1<- psi[id, 4]
b2<- psi[id, 5]
b3<- psi[id, 6]
b4<- psi[id, 7]
b5<- psi[id, 8]
b6<- psi[id, 9]
b7<- psi[id, 10]
b8<- psi[id, 11]
b9<- psi[id, 12]
b10<-psi[id, 13]
b11<-psi[id, 14]
yspline <- RES[,2]*b1 + RES[,3]*b2 + RES[,4]*b3 + RES[,5]*b4 +
RES[,6]*b5 + RES[,7]*b6 + RES[,8]*b7 + RES[,9]*b8 +
RES[,10]*b9 + RES[,11]*b10 + RES[,12]*b11
resp <- ypred + yspline
return(resp)
}
MSP10 <- MMSP.basis(x, min(x), max(x), ndx = 10, bdeg = bdeg, pord = pord, param = param)
names(MSP10)
X <- MSP10$X
Z <- MSP10$Z
aX <- dim(X)[2]
aZ <- dim(Z)[2]
aD <- dim(dataEA)[2]
RES <- cbind(X,Z)
dataEA10.full <-cbind(dataEA,Z)
colnames(dataEA10.full)[(aD+1):(aD+aZ)] <- paste0("Z",1:ncol(Z))
dataEA10.full.data <- saemixData(name.data = dataEA10.full, header = TRUE,
sep = " ", na = NA,
name.predictors = c("time",paste0("Z",1:aZ)),
name.response = c("y"),
units = list(x = "days", y = "log(beta-HCG)",
covariates = c("-")),
name.X = c("time"))
# Data SPNLME model EN 10 knots
write.csv(dataEA10.full, file = "dataEA-SPNLME10.csv", row.names = FALSE)
plot(dataEA10.full.data, plot.type="data")
SPEA10.saemix <-saemixModel(model=model.10n,
description = "SPNLME model knots = 10",
psi0 = matrix(c(coef(nlmeEA.fit)$fixed,rep(0,11)), ncol = 3+aZ, byrow = TRUE,
dimnames = list(NULL, c("a","b","c","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","b11"))),
transform.par = c(rep(0,3),rep(0,aZ)),
fixed.estim=c(rep(1,3+aZ)),
covariance.model = cbind(rbind(diag(14))))
##RUNS
K3 = 500
K4 = 100
c4 = 5
c5 = 5
c6 = 5
iterations = 1:(K3+K4+1)
end = K3+K4
options.sp<-list(seed=139546,map=FALSE,fim=FALSE,ll.is=TRUE,nb.chains = 5,
nbiter.mcmc = c(c4,c5,c6,0), nbiter.saemix = c(K3,K4),nbiter.sa=0.9,
displayProgress=TRUE,save.graphs=FALSE,nbiter.burn =0)
SPEA10.fit <- saemix(SPEA10.saemix, dataEA10.full.data, options.sp)
plot(SPEA10.fit, plot.type="individual.fit")
pdf("SPNLME-EA.10k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA10.fit) ~ time | id, data = dataEA10.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 10k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 10 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
######### Model 7 ###########
model.11n <-function(psi, id, x){
RES <- x
tim<-RES[,1]
a<-psi[id,1]
b<-psi[id,2]
c<-psi[id,3]
ypred<-a/(1+exp(-(tim-b)/c))
return(ypred)
##
b1<- psi[id, 4]
b2<- psi[id, 5]
b3<- psi[id, 6]
b4<- psi[id, 7]
b5<- psi[id, 8]
b6<- psi[id, 9]
b7<- psi[id, 10]
b8<- psi[id, 11]
b9<- psi[id, 12]
b10<-psi[id, 13]
b11<-psi[id, 14]
b12<-psi[id, 15]
yspline <- RES[,2]*b1 + RES[,3]*b2 + RES[,4]*b3 + RES[,5]*b4 +
RES[,6]*b5 + RES[,7]*b6 + RES[,8]*b7 + RES[,9]*b8 +
RES[,10]*b9 + RES[,11]*b10 +  RES[,12]*b11 + RES[,13]*b12
resp <- ypred + yspline
return(resp)
}
MSP11 <- MMSP.basis(x, min(x), max(x), ndx = 11, bdeg = bdeg, pord = pord, param = param)
names(MSP11)
X <- MSP11$X
Z <- MSP11$Z
aX <- dim(X)[2]
aZ <- dim(Z)[2]
aD <- dim(dataEA)[2]
RES <- cbind(X,Z)
dataEA11.full <-cbind(dataEA,Z)
colnames(dataEA11.full)[(aD+1):(aD+aZ)] <- paste0("Z",1:ncol(Z))
dataEA11.full.data <- saemixData(name.data = dataEA11.full, header = TRUE,
sep = " ", na = NA,
name.predictors = c("time",paste0("Z",1:aZ)),
name.response = c("y"),
units = list(x = "days", y = "log(beta-HCG)",
covariates = c("-")),
name.X = c("time"))
# Data SPNLME model EN 11 knots
write.csv(dataEA11.full, file = "dataEA-SPNLME11.csv", row.names = FALSE)
plot(dataEA11.full.data, plot.type="data")
SPEA11.saemix <-saemixModel(model=model.11n,
description = "SPNLME Model knots = 11",
psi0 = matrix(c(coef(nlmeEA.fit)$fixed,rep(0,12)), ncol = 3+aZ, byrow = TRUE,
dimnames = list(NULL, c("a","b","c","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","b11","b12"))),
transform.par = c(rep(0,3),rep(0,aZ)),
fixed.estim=c(rep(1,3+aZ)),
covariance.model = cbind(rbind(diag(15))))
##RUNS
K3 = 500
K4 = 100
c4 = 5
c5 = 5
c6 = 5
iterations = 1:(K3+K4+1)
end = K3+K4
options.sp<-list(seed=139546,map=FALSE,fim=FALSE,ll.is=TRUE,nb.chains = 5,
nbiter.mcmc = c(c4,c5,c6,0), nbiter.saemix = c(K3,K4),nbiter.sa=0.9,
displayProgress=TRUE,save.graphs=FALSE,nbiter.burn =0)
SPEA11.fit <- saemix(SPEA11.saemix, dataEA11.full.data, options.sp)
plot(SPEA11.fit, plot.type="individual.fit")
pdf("SPNLME-EA.11k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA11.fit) ~ time | id, data = dataEA11.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 11k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 11 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
model.12n <-function(psi, id, x){
RES <- x
tim<-RES[,1]
a<-psi[id,1]
b<-psi[id,2]
c<-psi[id,3]
ypred<-a/(1+exp(-(tim-b)/c))
return(ypred)
##
b1<- psi[id, 4]
b2<- psi[id, 5]
b3<- psi[id, 6]
b4<- psi[id, 7]
b5<- psi[id, 8]
b6<- psi[id, 9]
b7<- psi[id, 10]
b8<- psi[id, 11]
b9<- psi[id, 12]
b10<-psi[id, 13]
b11<-psi[id, 14]
b12<-psi[id,15]
b13<-psi[id,16]
yspline <- RES[,2]*b1 + RES[,3]*b2 + RES[,4]*b3 + RES[,5]*b4 + RES[,6]*b5 +
RES[,7]*b6 + RES[,8]*b7 + RES[,9]*b8 + RES[,10]*b9 + RES[,11]*b10 +
RES[,12]*b11 + RES[,13]*b12 + RES[,14]*b13
resp <- ypred + yspline
return(resp)
}
MSP12 <- MMSP.basis(x, min(x), max(x), ndx = 12, bdeg = bdeg, pord = pord, param = param)
names(MSP12)
X <- MSP12$X
Z <- MSP12$Z
aX <- dim(X)[2]
aZ <- dim(Z)[2]
aD <- dim(dataEA)[2]
RES <- cbind(X,Z)
dataEA12.full <-cbind(dataEA,Z)
colnames(dataEA12.full)[(aD+1):(aD+aZ)] <- paste0("Z",1:ncol(Z))
dataEA12.full.data <- saemixData(name.data = dataEA12.full, header = TRUE,
sep = " ", na = NA,
name.predictors = c("time",paste0("Z",1:aZ)),
name.response = c("y"),
units = list(x = "days", y = "log(beta-HCG)",
covariates = c("-")),
name.X = c("time"))
# Data SPNLME model EN 12 knots
write.csv(dataEA12.full, file = "dataEA-SPNLME12.csv", row.names = FALSE)
plot(dataEA12.full.data, plot.type="data")
SPEA12.saemix <-saemixModel(model=model.12n,
description = "SPNLME model knots = 12",
psi0 = matrix(c(coef(nlmeEA.fit)$fixed,rep(0,13)), ncol = 3+aZ, byrow = TRUE,
dimnames = list(NULL, c("a","b","c","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","b11","b12","b13"))),
transform.par = c(rep(0,3),rep(0,aZ)),
fixed.estim=c(rep(1,3+aZ)),
covariance.model = cbind(rbind(diag(16))))
##RUNS
K3 = 500
K4 = 100
c4 = 5
c5 = 5
c6 = 5
iterations = 1:(K3+K4+1)
end = K3+K4
options.sp<-list(seed=139546,map=FALSE,fim=FALSE,ll.is=TRUE,nb.chains = 5,
nbiter.mcmc = c(c4,c5,c6,0), nbiter.saemix = c(K3,K4),nbiter.sa=0.9,
displayProgress=TRUE,save.graphs=FALSE,nbiter.burn =0)
SPEA12.fit <- saemix(SPEA12.saemix, dataEA12.full.data, options.sp)
plot(SPEA12.fit, plot.type="individual.fit")
pdf("SPNLME.12k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 12k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 12 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
pdf("SPNLME-EA.12k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l"), distribute.type = TRUE,col.line=c("blue","#DB3B1B","#E6CE17"), lwd=2,
xlab = "days", ylab = "log(beta-HCG)", layout=c(4,2), main="NLME - SPNLME 12k", sub="id - abnormal group",
auto.key = list(points=FALSE, lines = FALSE, space = "right", text= c("Observations","NLME", "SPNLME 12 knots"),
col=c("blue","#DB3B1B","#E6CE17")))
dev.off()
pdf("SPNLME-EA-evenknots.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA6.fit) + fitted(SPEA8.fit) + fitted(SPEA10.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l","l","l","l"), distribute.type = TRUE, col.line=c("blue","black","magenta","green","red","darkblue"),
xlab = "Time (days)", ylab = "log(beta-HCG)",layout=c(4,2), main="NLME - SPNLME (even knots)", sub="id - abnormal group",
auto.key =list(points = FALSE,lines = FALSE, space = "right",
text = c("Observaciones","NLME","SPNLME 6k", "SPNLME 8k", "SPNLME 10k", "SPNLME 12k"),
col=c("blue","black","magenta","green","red","darkblue")))
dev.off()
pdf("SPNLME-EA-evenknots.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA6.fit) + fitted(SPEA8.fit) + fitted(SPEA10.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l","l","l","l"), distribute.type = TRUE, col.line=c("blue","black","magenta","green","red","darkblue"), lwd=2,
xlab = "Time (days)", ylab = "log(beta-HCG)",layout=c(4,2), main="NLME - SPNLME (even knots)", sub="id - abnormal group",
auto.key =list(points = FALSE,lines = FALSE, space = "right",
text = c("Observaciones","NLME","SPNLME 6k", "SPNLME 8k", "SPNLME 10k", "SPNLME 12k"),
col=c("blue","black","magenta","green","red","darkblue")))
dev.off()
pdf("SPNLME-EA-evenknots.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA6.fit) + fitted(SPEA8.fit) + fitted(SPEA10.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l","l","l","l"), distribute.type = TRUE, col.line=c("blue","black","magenta","green","red","darkblue"), lwd=2,
xlab = "Time (days)", ylab = "log(beta-HCG)",layout=c(4,2), main="NLME - SPNLME (even knots)", sub="id - abnormal group",
auto.key =list(points = FALSE,lines = FALSE, space = "right",
text = c("Observations","NLME","SPNLME 6k", "SPNLME 8k", "SPNLME 10k", "SPNLME 12k"),
col=c("blue","black","magenta","green","red","darkblue")))
dev.off()
pdf("SPNLME-EA-oddknots.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA5.fit) + fitted(SPEA7.fit) + fitted(SPEA9.fit) + fitted(SPEA11.fit) ~ time | id, data = dataEA11.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l","l","l","l"), distribute.type = TRUE, col.line=c("blue","black","magenta","green","red","darkblue"), lwd=2,
xlab = "Time (days)", ylab = "log(beta-HCG)",layout=c(4,2), main="NLME - SPNLME (odd knots)", sub="id - abnormal group",
auto.key =list(points = FALSE,lines = FALSE, space = "right",
text = c("Observations","NLME","SPNLME 5k", "SPNLME 7k", "SPNLME 9k", "SPNLME 11k"),
col=c("blue","black","magenta","green","red","darkblue")))
dev.off()
pdf("SPNLME-EA.11k-12k.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA11.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l","l"), distribute.type = TRUE, col.line=c("blue","black","magenta","darkblue"), lwd=2,
xlab = "Time (days)", ylab = "log(beta-HCG)",layout=c(4,2), main="NLME - SPNLME 11, 12 knots", sub="id - abnormal group",
auto.key =list(points = FALSE,lines = FALSE, space = "right",
text = c("Observations","NLME","SPNLME 11k", "SPNLME 12k"),
col=c("blue","black","magenta","darkblue")))
dev.off()
pdf("SPNLME-EA.5-12.pdf")
xyplot(y + fitted(nlmeEA.fit) + fitted(SPEA5.fit) + fitted(SPEA8.fit) + fitted(SPEA11.fit) + fitted(SPEA12.fit) ~ time | id, data = dataEA12.full,
subset = c(which(id==125), which(id==127), which(id==143), which(id==144),
which(id==156),which(id==164), which(id==168), which(id==169)),
strip = FALSE, aspect = "xy", pch = 16, grid = TRUE,
type = c("p","l","l","l","l","l"), distribute.type = TRUE, col.line=c("blue","red","black","darkblue", "green", "magenta"), lwd=2,
xlab = "Time (days)", ylab = "log(beta-HCG)",layout=c(4,2), main="NLME - SPNLME 5, 8, 11, 12 knots", sub="id - abnormal group",
auto.key =list(points = FALSE,lines = FALSE, space = "right",
text = c("Observaciones","NLME","SPNLME 5k", "SPNLME 8k", "SPNLME 11k", "SPNLME 12k"),
col=c("blue","red","black","darkblue", "green", "magenta")))
dev.off()
